<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
        <link rel="stylesheet" href="/css/home.css">
        <title>Home - My Cosmetic Brand</title>
    </head>
<body>
    <header>
        <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top">
            <h1 class="navbar-brand"><a href="/">Health&Care</a></h1>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item <%= page === 'home' ? 'active' : '' %>"><a class="nav-link" href="/">HOME</a></li>
                    <li class="nav-item <%= page === 'bmi' ? 'active' : '' %>"><a class="nav-link" href="/bmiCalculator">BMI</a></li>
                    <li class="nav-item <%= page === 'nutrient' ? 'active' : '' %>"><a class="nav-link" href="/nutrient">NUTRIENT</a></li>
                    <% if (user && user.isAdmin) { %>
                        <li class="nav-item <%= page === 'admin' ? 'active' : '' %>"><a class="nav-link" href="/admin">Admin</a></li>
                    <% } else if (user) { %>
                        <li class="nav-item <%= page === 'profile' ? 'active' : '' %>"><a class="nav-link" href="/profile">Profile</a></li>
                    <% } else { %>
                        <li class="nav-item <%= page === 'login' ? 'active' : '' %>"><a class="nav-link" href="/login">Log in</a></li>
                    <% } %>
                </ul>
            </div>
        </nav>
    </header>
    
    <main>
        <section class="hero">
            <div id="carouselExampleCaptions" class="carousel slide" data-ride="carousel">
                <ol class="carousel-indicators">
                    <li data-target="#carouselExampleCaptions" data-slide-to="0" class="active"></li>
                    <li data-target="#carouselExampleCaptions" data-slide-to="1"></li>
                    <li data-target="#carouselExampleCaptions" data-slide-to="2"></li>
                </ol>
                <div class="carousel-inner">
                    <div class="carousel-item active">
                    <img src="/img/home_1.jpg" class="d-block w-100" alt="...">
                    <div class="carousel-caption d-none d-md-block">
                        <h5>Discover new horizons of beauty</h5>
                        <p>Try our exclusive new products in cosmetics. Unique formulas for the health and radiance of your skin.</p>
                    </div>
                    </div>
                    <div class="carousel-item">
                    <img src="/img/home_2.jpg" class="d-block w-100" alt="...">
                    <div class="carousel-caption d-none d-md-block">
                        <h5>Learn from the professionals</h5>
                        <p>Watch our tutorials on makeup and skin care. Step-by-step instructions from leading cosmetologists.</p>
                    </div>
                    </div>
                    <div class="carousel-item">
                    <img src="/img/home_3.jpg" class="d-block w-100" alt="...">
                    <div class="carousel-caption d-none d-md-block">
                        <h5>Discounts and promotions on your favorite products</h5>
                        <p>Don't miss the chance to buy the best cosmetics at special prices. Beauty should be accessible to everyone.</p>
                    </div>
                    </div>
                </div>
                <a class="carousel-control-prev" href="#carouselExampleCaptions" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleCaptions" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
            <section class="welcome my-5">
                <h2>Welcome to Health & Care Hub</h2>
                <p><strong id="greeting"></strong><strong> Welcome to Health & Care Hub — your partner in promoting a healthy lifestyle and radiant skin.</strong>
                    At Health & Care Hub, we believe that health and beauty go hand in hand. We are here to guide you on a journey towards optimal well-being, focusing on skin care that nourishes and rejuvenates from the inside out. Our mission is to offer more than just products — we provide holistic solutions designed to enhance your health, appearance, and overall wellness.
                    Our carefully selected range of skincare products is made with natural, high-quality ingredients suitable for all skin types. From trusted brands to unique innovations, every item we feature is designed to nourish your skin while promoting long-term health benefits.
                    Along with our products, we offer informative guides and tutorials to help you incorporate healthy practices into your daily routine. Whether you're looking to improve your skin health or embrace a new wellness habit, our educational resources make it easy and enjoyable to take care of yourself.
                </p>
            
                <dl><p>At Health & Care Hub, we are dedicated to empowering you with the knowledge and tools to care for your skin and overall health. We believe that everyone deserves to look and feel their best, every single day.</p></dl>
            </section>

            <section id="weather" class="my-5">
                <h2>Current Weather in Astana</h2>
                <p>Temperature: <span id="temperature"></span> °C</p>
                <p>Description: <span id="description"></span></p>
                <p>Icon: <img id="icon" class="weather-icon" src="" alt="Weather icon"></p>
                <p>Coordinates: <span id="coordinates"></span></p>
                <p>Feels Like: <span id="feels-like"></span> °C</p>
                <p>Humidity: <span id="humidity"></span> %</p>
                <p>Pressure: <span id="pressure"></span> hPa</p>
                <p>Wind Speed: <span id="wind-speed"></span> m/s</p>
                <p>Country Code: <span id="country-code"></span></p>
                <p>Rain Volume (last 3 hours): <span id="rain-volume"></span> mm</p>
            </section>
            
            <section class="motivational my-5 text-center">
                <h2>Stay Healthy and Beautiful</h2>
                <p>"Health is the greatest gift, contentment the greatest wealth, faithfulness the best relationship." - Buddha</p>
                <p>At Health & Care Hub, we believe in nurturing your body, mind, and soul. Our products and services are designed to support your journey to wellness and beauty.</p>
            </section>
            
            <section id="map" class="my-5" style="height: 500px;">
                <h2>Map Location</h2>
                <div id="mapid" style="height: 100%;"></div>
            </section>
            
            <div class="container my-5">
                <div class="row">
                    <% if (products && products.length > 0) { %>
                        <% products.forEach(product => { %>
                            <div class="col-md-4">
                                <div class="card mb-4">
                                    <% if (product.images && product.images.length > 0) { %>
                                        <div id="carousel<%= product._id %>" class="carousel slide" data-ride="carousel">
                                            <div class="carousel-inner">
                                                <% product.images.forEach((image, index) => { %>
                                                    <div class="carousel-item <%= index === 0 ? 'active' : '' %>">
                                                        <img src="<%= image %>" class="d-block w-100" alt="<%= product.title %>" style="max-height: 200px; object-fit: cover;">

                                                    </div>
                                                <% }); %>
                                            </div>
                                            <a class="carousel-control-prev" href="#carousel<%= product._id %>" role="button" data-slide="prev">
                                                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                                <span class="sr-only">Previous</span>
                                            </a>
                                            <a class="carousel-control-next" href="#carousel<%= product._id %>" role="button" data-slide="next">
                                                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                                <span class="sr-only">Next</span>
                                            </a>
                                        </div>
                                    <% } %>
                                    <div class="card-body">
                                        <h5 class="card-title"><%= product.title %></h5>
                                        <h6 class="card-subtitle mb-2 text-muted">Category: <%= product.category %></h6>
                                        <p class="card-text"><%= product.description %></p>
                                        <% if (user && user.isAdmin) { %>
                                            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#editModal<%= product._id %>">Edit</button>
                                            <button type="button" class="btn btn-danger mt-2" onclick="clearProduct('<%= product._id %>')">Delete</button>
                                        <% } %>
                                    </div>
                                </div>
                            </div>
                            <div class="modal fade" id="editModal<%= product._id %>" tabindex="-1" role="dialog" aria-labelledby="editModalLabel<%= product._id %>" aria-hidden="true">
                                <div class="modal-dialog" role="document">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title">Edit the product</h5>
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Закрыть">
                                                <span aria-hidden="true">&times;</span>
                                            </button>
                                        </div>
                                        <form action="/update/<%= product._id %>" method="post">
                                            <div class="modal-body">
                                                <div class="form-group">
                                                    <label for="title<%= product._id %>">Title:</label>
                                                    <input type="text" class="form-control" id="title<%= product._id %>" name="title" value="<%= product.title %>">
                                                </div>
                                                <div class="form-group">
                                                    <label for="category<%= product._id %>">Category:</label>
                                                    <input type="text" class="form-control" id="category<%= product._id %>" name="category" value="<%= product.category %>">
                                                </div>
                                                <div class="form-group">
                                                    <label for="description<%= product._id %>">Description:</label>
                                                    <textarea class="form-control" id="description<%= product._id %>" name="description"><%= product.description %></textarea>
                                                </div>
                                                <div class="form-group">
                                                    <label for="images<%= product._id %>">URL images (maximum 3, separated by commas):</label>
                                                    <input type="text" class="form-control" id="images<%= product._id %>" name="images" value="<%= product.images.join(', ') %>">
                                                </div>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                <button type="submit" class="btn btn-primary">Save</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        <% }); %>
        
                        <% if (user && user.isAdmin) { %>
                            <% const emptyBlocks = 3 - products.length; %>
                            <% for (let i = 0; i < emptyBlocks; i++) { %>
                                <div class="col-md-4">
                                    <div class="card mb-4">
                                        <div class="card-body">
                                            <h5 class="card-title"> New product</h5>
                                            <button type="button" class="btn btn-success" data-toggle="modal" data-target="#createModal<%= i %>">Создать</button>
                                        </div>
                                    </div>
                                </div>
        
                                <div class="modal fade" id="createModal<%= i %>" tabindex="-1" role="dialog" aria-labelledby="createModalLabel<%= i %>" aria-hidden="true">
                                    <div class="modal-dialog" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title">Add a new product</h5>
                                                <button type="button" class="close" data-dismiss="modal" aria-label="Закрыть">
                                                    <span aria-hidden="true">&times;</span>
                                                </button>
                                            </div>
                                            <form action="/add-product" method="post">
                                                <div class="modal-body">
                                                    <div class="form-group">
                                                        <label for="titleNew<%= i %>">Name:</label>
                                                        <input type="text" class="form-control" id="titleNew<%= i %>" name="title" value="">
                                                    </div>
                                                    <div class="form-group">
                                                        <label for="categoryNew<%= i %>">Category:</label>
                                                        <input type="text" class="form-control" id="categoryNew<%= i %>" name="category" value="">
                                                    </div>
                                                    <div class="form-group">
                                                        <label for="descriptionNew<%= i %>">Description:</label>
                                                        <textarea class="form-control" id="descriptionNew<%= i %>" name="description"></textarea>
                                                    </div>
                                                    <div class="form-group">
                                                        <label for="imagesNew<%= i %>">URL images (maximum 3, separated by commas):</label>
                                                        <input type="text" class="form-control" id="imagesNew<%= i %>" name="images" value="">
                                                    </div>
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                    <button type="submit" class="btn btn-primary">Save</button>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            <% } %>
                        <% } %>
                    <% } else { %>
                        <% if (user && user.isAdmin) { %>
                            <% for (let i = 0; i < 3; i++) { %>
                                <div class="col-md-4">
                                    <div class="card mb-4">
                                        <div class="card-body">
                                            <h5 class="card-title">New product</h5>
                                            <button type="button" class="btn btn-success" data-toggle="modal" data-target="#createModal<%= i %>">Создать</button>
                                        </div>
                                    </div>
                                </div>
        
                                <div class="modal fade" id="createModal<%= i %>" tabindex="-1" role="dialog" aria-labelledby="createModalLabel<%= i %>" aria-hidden="true">
                                    <div class="modal-dialog" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title">Add a new product</h5>
                                                <button type="button" class="close" data-dismiss="modal" aria-label="Закрыть">
                                                    <span aria-hidden="true">&times;</span>
                                                </button>
                                            </div>
                                            <form action="/add-product" method="post">
                                                <div class="modal-body">
                                                    <div class="form-group">
                                                        <label for="titleNew<%= i %>">Name:</label>
                                                        <input type="text" class="form-control" id="titleNew<%= i %>" name="title" value="">
                                                    </div>
                                                    <div class="form-group">
                                                        <label for="categoryNew<%= i %>">Category:</label>
                                                        <input type="text" class="form-control" id="categoryNew<%= i %>" name="category" value="">
                                                    </div>
                                                    <div class="form-group">
                                                        <label for="descriptionNew<%= i %>">Description:</label>
                                                        <textarea class="form-control" id="descriptionNew<%= i %>" name="description"></textarea>
                                                    </div>
                                                    <div class="form-group">
                                                        <label for="imagesNew<%= i %>">URL images (maximum 3, separated by commas):</label>
                                                        <input type="text" class="form-control" id="imagesNew<%= i %>" name="images" value="">
                                                    </div>
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                    <button type="submit" class="btn btn-primary">Save</button>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            <% } %>
                        <% } else { %>
                            <p>Products are not found.</p>
                        <% } %>
                    <% } %>
                </div>
            </div>
        </section>
    </main>
    <footer>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
        <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
        <script src="/js/home.js"></script>
        <p style="text-align: center;">&copy; Ali Ainur, Akerke Kassymbekova, Darina Abdukadirova, IT-2308</p>
        <script>
            function clearProduct(id) {
                fetch(`/clear-product/${id}`, {
                    method: 'POST'
                })
                .then(response => {
                    if (response.ok) {
                        location.reload();
                    } else {
                        console.error('Error clearing product');
                    }
                });
            }
        </script>
    </footer>
</body>
</html>
